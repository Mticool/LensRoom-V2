# üé® –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏

## –û–ø–∏—Å–∞–Ω–∏–µ

–§—É–Ω–∫—Ü–∏—è "Remix" –≤ –∏—Å—Ç–æ—Ä–∏–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

## üéØ –ì–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç:** `HistorySidebar` (–ø—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å –≤ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–µ)  
**–ö–Ω–æ–ø–∫–∞:** "Remix" (–ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ hover –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)

## üìç –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –ò—Å—Ç–æ—Ä–∏—è                    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ [Thumbnail]  –ü—Ä–æ–º–ø—Ç ‚îÇ    ‚îÇ ‚Üê –ö–∞—Ä—Ç–æ—á–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
‚îÇ  ‚îÇ              Time   ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                     ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ [Remix] [Copy] [‚ü≥] ‚îÇ    ‚îÇ ‚Üê –î–µ–π—Å—Ç–≤–∏—è (on hover)
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π Flow:

1. **–ù–∞–π—Ç–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ** –≤ –∏—Å—Ç–æ—Ä–∏–∏ (–ø—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å)
2. **–ù–∞–≤–µ—Å—Ç–∏ –∫—É—Ä—Å–æ—Ä** –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É
3. **–ù–∞–∂–∞—Ç—å "Remix"** (–ø–µ—Ä–≤–∞—è –∫–Ω–æ–ø–∫–∞ —Å–ª–µ–≤–∞, —Ñ–∏–æ–ª–µ—Ç–æ–≤–∞—è)
4. –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
   - ‚úÖ –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∫–∞–∫ blob
   - ‚úÖ –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ base64
   - ‚úÖ –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ Remix –∏–ª–∏ Batch —Ä–µ–∂–∏–º
   - ‚úÖ –ü—Ä–æ–º–ø—Ç –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è
   - ‚úÖ –°–∫—Ä–æ–ª–ª –∫ —Ñ–æ—Ä–º–µ —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ textarea

### –í –æ–±—ã—á–Ω–æ–º —Ä–µ–∂–∏–º–µ:
```
–ù–∞–∂–∞—Ç—å "Remix" ‚Üí –í–∫–ª—é—á–∞–µ—Ç—Å—è Remix —Ä–µ–∂–∏–º ‚Üí –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ
```

### –í Batch —Ä–µ–∂–∏–º–µ:
```
–ù–∞–∂–∞—Ç—å "Remix" ‚Üí –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ batch –º–∞—Å—Å–∏–≤
```

## üíª –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –õ–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:

```typescript
async function handleEditFromHistory(result: GenerationResult) {
  // 1. Fetch –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
  const response = await fetch(result.previewUrl || result.url);
  const blob = await response.blob();
  
  // 2. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ base64
  const reader = new FileReader();
  reader.onloadend = () => {
    const dataUrl = reader.result as string;
    
    // 3a. Batch —Ä–µ–∂–∏–º - –¥–æ–±–∞–≤–∏—Ç—å –≤ –º–∞—Å—Å–∏–≤
    if (batchMode) {
      setBatchImages(prev => [...prev, {
        id: crypto.randomUUID(),
        preview: dataUrl,
        status: 'ready',
        source: 'history',
      }]);
    }
    
    // 3b. –û–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º - –≤–∫–ª—é—á–∏—Ç—å Remix
    else {
      setReferenceImage(dataUrl);
    }
    
    // 4. –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–º–ø—Ç
    setCurrentPrompt(result.prompt);
    
    // 5. –°–∫—Ä–æ–ª–ª –∫ —Ñ–æ—Ä–º–µ
    textarea.scrollIntoView({ behavior: 'smooth' });
  };
  
  reader.readAsDataURL(blob);
}
```

### –°–æ—Å—Ç–æ—è–Ω–∏—è UI:

**Loading:**
```
Toast: "–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è..."
```

**Success (Remix —Ä–µ–∂–∏–º):**
```
Toast: "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è ‚úì"
Canvas: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç Remix UI —Å –ø—Ä–µ–≤—å—é
PromptBar: –ó–∞–ø–æ–ª–Ω–µ–Ω –ø—Ä–æ–º–ø—Ç–æ–º
```

**Success (Batch —Ä–µ–∂–∏–º):**
```
Toast: "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ Batch ‚úì"
Canvas: –î–æ–±–∞–≤–ª–µ–Ω –≤ –≥–∞–ª–µ—Ä–µ—é batch –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
PromptBar: –ó–∞–ø–æ–ª–Ω–µ–Ω –ø—Ä–æ–º–ø—Ç–æ–º
```

**Error:**
```
Toast: "–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ"
```

## üé® –í–∏–∑—É–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã

### –ö–Ω–æ–ø–∫–∞ –≤ –∏—Å—Ç–æ—Ä–∏–∏:

```tsx
<button className="hover:bg-[#A855F7]/20 hover:text-[#A855F7]">
  <Edit className="w-3 h-3" />
  <span>Remix</span>
</button>
```

**–¶–≤–µ—Ç:** –§–∏–æ–ª–µ—Ç–æ–≤—ã–π (#A855F7)  
**–ò–∫–æ–Ω–∫–∞:** Edit (lucide-react)  
**–ü–æ–∑–∏—Ü–∏—è:** –ü–µ—Ä–≤–∞—è –≤ —Å–ø–∏—Å–∫–µ –¥–µ–π—Å—Ç–≤–∏–π

### –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è:
- ‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (`mode === 'image'`)
- ‚ùå –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥–ª—è –≤–∏–¥–µ–æ

## üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–µ–∂–∏–º–∞–º–∏

| –¢–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º | –î–µ–π—Å—Ç–≤–∏–µ –ø—Ä–∏ Remix | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|---------------|-------------------|-----------|
| **–û–±—ã—á–Ω—ã–π** | –í–∫–ª—é—á–∞–µ—Ç Remix —Ä–µ–∂–∏–º | `referenceImage = dataUrl` |
| **Remix** | –ó–∞–º–µ–Ω—è–µ—Ç —Ç–µ–∫—É—â–µ–µ | `referenceImage = dataUrl` |
| **Batch** | –î–æ–±–∞–≤–ª—è–µ—Ç –≤ –º–∞—Å—Å–∏–≤ | `batchImages.push(...)` |

## üì± –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å

**Desktop:**
- ‚úÖ –ö–Ω–æ–ø–∫–∞ —Å —Ç–µ–∫—Å—Ç–æ–º "Remix"
- ‚úÖ –¢—Ä–∏ –∫–Ω–æ–ø–∫–∏ –≤ —Ä—è–¥

**Mobile:**
- ‚úÖ –¢–æ–ª—å–∫–æ –∏–∫–æ–Ω–∫–∏ (–±–µ–∑ —Ç–µ–∫—Å—Ç–∞)
- ‚úÖ –ö–æ–º–ø–∞–∫—Ç–Ω–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ

## üéì Use Cases

### 1. –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ
```
1. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª –ø–æ—Ä—Ç—Ä–µ—Ç
2. –ù–∞–∂–∞–ª "Remix" –≤ –∏—Å—Ç–æ—Ä–∏–∏
3. –ü—Ä–æ–º–ø—Ç: "Add better lighting"
4. –ü–æ–ª—É—á–∏–ª —É–ª—É—á—à–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é
```

### 2. –í–∞—Ä–∏–∞—Ü–∏–∏ —Å—Ç–∏–ª—è
```
1. –ù–∞—à—ë–ª —É–¥–∞—á–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏–∏
2. –ù–∞–∂–∞–ª "Remix"
3. –ü—Ä–æ–º–ø—Ç: "Convert to anime style"
4. –ü–æ–ª—É—á–∏–ª –≤ –¥—Ä—É–≥–æ–º —Å—Ç–∏–ª–µ
```

### 3. Batch –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
```
1. –í–∫–ª—é—á–∏–ª Batch —Ä–µ–∂–∏–º
2. –ù–∞—à—ë–ª 3 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –∏—Å—Ç–æ—Ä–∏–∏
3. –ù–∞–∂–∞–ª "Remix" –Ω–∞ –∫–∞–∂–¥–æ–º
4. –ü—Ä–∏–º–µ–Ω–∏–ª –æ–¥–∏–Ω –ø—Ä–æ–º–ø—Ç –∫–æ –≤—Å–µ–º
```

## üêõ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

**–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ:**
```typescript
if (!imageUrl) {
  toast.error('–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ');
  return;
}
```

**–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:**
```typescript
reader.onerror = () => {
  toast.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è');
};
```

**–°–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞:**
```typescript
catch (error) {
  toast.error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ');
}
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Scroll behaviour:
```typescript
textarea.scrollIntoView({ 
  behavior: 'smooth',
  block: 'center'
});
```

### Focus –ø–æ—Å–ª–µ —Å–∫—Ä–æ–ª–ª–∞:
```typescript
setTimeout(() => {
  textarea.focus();
}, 100);
```

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–ë—ã—Å—Ç—Ä–æ—Ç–∞** - –æ–¥–∏–Ω –∫–ª–∏–∫ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
2. **–ö–æ–Ω—Ç–µ–∫—Å—Ç** - –ø—Ä–æ–º–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è
3. **–ì–∏–±–∫–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –æ–±—ã—á–Ω–æ–º –∏ batch —Ä–µ–∂–∏–º–∞—Ö
4. **UX** - –ø–ª–∞–≤–Ω—ã–π —Å–∫—Ä–æ–ª–ª –∏ —Ñ–æ–∫—É—Å

## üìä –°–≤—è–∑–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

- `HistorySidebar.tsx` - UI –∫–Ω–æ–ø–∫–∏
- `GeneratorV2.tsx` - –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- `Canvas.tsx` - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
- `ImageUploader.tsx` - Remix UI
- `BatchImageUploader.tsx` - Batch UI

---

**–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üöÄ


