# Batch Mode - UI Layout

## 📐 Расположение компонентов

```
┌─────────────────────────────────────────────────────────────┐
│                         HEADER                               │
│  Logo  [Фото] [Видео] [E-com]  [Стили] [Remix] [Batch] ... │
│                                                    ↑          │
│                                              Кнопка Batch    │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│                                                               │
│                         CANVAS                                │
│                                                               │
│  Когда batch режим ВЫКЛЮЧЕН:                                 │
│    - Обычное поле для генерации                             │
│    - Или Remix режим с одним изображением                    │
│                                                               │
│  Когда batch режим ВКЛЮЧЕН:                                  │
│    - BatchImageUploader занимает Canvas                      │
│    - Показывает "Batch режим" бейдж                         │
│    - Превью загруженных изображений                          │
│                                                               │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│                      PROMPT BAR                              │
│  ┌───────────────────────────────────────────────────────┐  │
│  │ Опишите изображение...                  [100⭐] [→]  │  │
│  └───────────────────────────────────────────────────────┘  │
│                           ↓                                  │
│                 BATCH IMAGE UPLOADER                         │
│         (показывается только в batch режиме)                │
│  ┌───────────────────────────────────────────────────────┐  │
│  │  [+] Добавить изображения (3/10)              ▼      │  │
│  │                                                        │  │
│  │  ┌────┐ ┌────┐ ┌────┐                                │  │
│  │  │img1│ │img2│ │img3│  ← Превью загруженных          │  │
│  │  └────┘ └────┘ └────┘                                │  │
│  │                                                        │  │
│  │  Выпадающее меню при клике на [+]:                   │  │
│  │  ┌────────────────────────┐                           │  │
│  │  │ 📤 Загрузить файлы     │                          │  │
│  │  │ 🕒 Из сгенерированных  │                          │  │
│  │  └────────────────────────┘                           │  │
│  └───────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
```

## 🎯 Состояния интерфейса

### 1. **Обычный режим** (default)
- ✅ Canvas: пустое состояние с примерами
- ✅ PromptBar: обычное поле ввода
- ❌ BatchImageUploader: скрыт

### 2. **Remix режим** (referenceImage !== null)
- ✅ Canvas: показывает ImageUploader
- ✅ PromptBar: обычное поле ввода
- ❌ BatchImageUploader: скрыт
- ✅ Кнопка "Remix": активна (подсвечена)

### 3. **Batch режим** (batchMode === true)
- ✅ Canvas: показывает BatchImageUploader (дублирование для visibility)
- ✅ PromptBar: обычное поле ввода
- ✅ BatchImageUploader: показан ПОД промптом
- ✅ Кнопка "Batch": активна (подсвечена)
- ❌ Кнопка "Remix": скрыта

## 📱 Расположение на разных устройствах

### Desktop (>1024px)
```
┌─SettingsPanel ─┬───── Canvas ──────┬─ History ─┐
│                 │                   │           │
│  [Модели]       │    [Контент]     │ [Работы] │
│  [Формат]       │                   │          │
│  [Референс]     │    BatchUploader │          │
│                 │    (в Canvas)     │          │
│                 │                   │          │
│                 ├───────────────────┤          │
│                 │   PromptBar       │          │
│                 │   BatchUploader   │          │
│                 │   (под промптом)  │          │
└─────────────────┴───────────────────┴──────────┘
```

### Mobile (<768px)
```
┌─────────────────────────┐
│       Canvas            │
│                         │
│   BatchUploader         │
│   (в Canvas)            │
│                         │
├─────────────────────────┤
│   PromptBar             │
│   BatchUploader         │
│   (под промптом)        │
└─────────────────────────┘

Settings и History - через модальные окна
```

## 🎨 BatchImageUploader детали

### Компонент под промптом:
```
┌─────────────────────────────────────────┐
│  [+] Добавить изображения (3/10)   ▼   │  ← Кнопка + счётчик
├─────────────────────────────────────────┤
│  ┌────┐ ┌────┐ ┌────┐                  │
│  │img1│ │img2│ │img3│                  │  ← Превью 80x80px
│  │ ❌ │ │ ❌ │ │ ❌ │  (on hover)      │
│  └────┘ └────┘ └────┘                  │
│                                         │
│  PNG, JPG, WEBP • До 10MB • Макс 10    │  ← Подсказка
└─────────────────────────────────────────┘
```

### Выпадающее меню:
```
┌────────────────────────┐
│ 📤 Загрузить файлы     │  ← input[type="file" multiple]
├────────────────────────┤
│ 🕒 Из сгенерированных  │  ← Открывает HistoryImagePicker
└────────────────────────┘
```

### Drag & Drop состояние:
```
┌─────────────────────────────────────────┐
│        🔵 Отпустите для загрузки        │  ← Подсветка
│                                         │
│         (анимация пульсации)            │
└─────────────────────────────────────────┘
```

## 🔄 Взаимодействие компонентов

### Canvas BatchImageUploader (большой)
**Цель:** Основной интерфейс загрузки  
**Когда:** Пустое состояние в batch режиме  
**Функции:**
- Большая drag & drop зона
- Выпадающее меню
- Превью изображений
- Кнопка истории

### PromptBar BatchImageUploader (компактный)
**Цель:** Управление после загрузки  
**Когда:** Всегда в batch режиме (под промптом)  
**Функции:**
- Компактная кнопка добавления
- Маленькие превью (80x80)
- Счётчик изображений
- Быстрое удаление

**Оба компонента синхронизированы** через один state:
```typescript
const [batchImages, setBatchImages] = useState<UploadedImage[]>([]);
```

## 💡 UX Flow

```
1. Пользователь нажимает "Batch"
   └─> batchMode = true
   └─> Canvas показывает BatchImageUploader

2. Загружает изображения (drag & drop или меню)
   └─> batchImages.length > 0
   └─> Превью появляется в Canvas и под промптом

3. Пишет промпт
   └─> "Add neon lighting"

4. Нажимает "Создать"
   └─> Система обрабатывает все изображения

5. Получает результаты
   └─> Каждое изображение = отдельная генерация
```

## 🎯 Почему два компонента?

### Canvas BatchImageUploader:
- **Первое впечатление** - большой заметный интерфейс
- **Пустое состояние** - занимает всё пространство Canvas
- **Drag & Drop** - большая удобная зона

### PromptBar BatchImageUploader:
- **Постоянный доступ** - всегда виден внизу
- **Управление** - легко добавить/удалить изображения
- **Контекст** - рядом с промптом для удобства

## 📊 Анимации и переходы

```typescript
// Появление BatchImageUploader
<div className="animate-in fade-in slide-in-from-top-2 duration-200">

// Drag over эффект
border-[#00D9FF] bg-[#00D9FF]/10 scale-[1.02]

// Удаление изображения
opacity-0 group-hover:opacity-100 transition-opacity
```

---

**Итог:** BatchImageUploader интегрирован в два места для максимального UX! 🚀


