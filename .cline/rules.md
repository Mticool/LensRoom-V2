# –ü—Ä–∞–≤–∏–ª–∞ —Ä–∞–±–æ—Ç—ã –∞–≥–µ–Ω—Ç–∞ Cline –¥–ª—è LensRoom V2

> –≠—Ç–æ—Ç —Ñ–∞–π–ª ‚Äî –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è AI-–∞–≥–µ–Ω—Ç–∞. –ù–µ —É–¥–∞–ª—è—Ç—å –∏ –Ω–µ –∏–∑–º–µ–Ω—è—Ç—å –±–µ–∑ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è.

---

## üéØ –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã

### 1. Minimal Diff ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- **–ù–∏–∫–æ–≥–¥–∞** –Ω–µ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–π —Ñ–∞–π–ª—ã —Ü–µ–ª–∏–∫–æ–º –±–µ–∑ —è–≤–Ω–æ–π –ø—Ä–∏—á–∏–Ω—ã
- –ò—Å–ø–æ–ª—å–∑—É–π `replace_in_file` –¥–ª—è —Ç–æ—á–µ—á–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –û–¥–∏–Ω PR = –æ–¥–Ω–∞ –∑–∞–¥–∞—á–∞, –º–∏–Ω–∏–º—É–º –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤

### 2. –°–Ω–∞—á–∞–ª–∞ –ø–æ–Ω—è—Ç—å, –ø–æ—Ç–æ–º –¥–µ–ª–∞—Ç—å
- –ü—Ä–æ—á–∏—Ç–∞–π —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º
- –ü—Ä–æ–≤–µ—Ä—å –∏–º–ø–æ—Ä—Ç—ã –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –ù–∞–π–¥–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –≤ –∫–æ–¥–µ

### 3. –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º
- –ò—â–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã –≤ `lib/`
- –ü—Ä–æ–≤–µ—Ä—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤ `components/ui/`
- –ò—Å–ø–æ–ª—å–∑—É–π —Ö—É–∫–∏ –∏–∑ `hooks/` –∏ `stores/`

### 4. –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∫—Ä—É–ø–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
–ü–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∑–∞–ø—Ä–æ—Å–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:
- –£–¥–∞–ª–µ–Ω–∏–µ/–ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
- –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –±–æ–ª–µ–µ 3 —Ñ–∞–π–ª–æ–≤
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ API
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ë–î

### 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
–í—Å–µ–≥–¥–∞ –ø—Ä–µ–¥–ª–∞–≥–∞–π –∫–æ–º–∞–Ω–¥—ã –ø—Ä–æ–≤–µ—Ä–∫–∏:
```bash
npm run lint          # ESLint
npm run type-check    # TypeScript
npm run build         # Production build
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
lensroom-v2/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ app/           # Next.js App Router (—Å—Ç—Ä–∞–Ω–∏—Ü—ã, API)
‚îÇ   ‚îú‚îÄ‚îÄ components/    # React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ config/        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–º–æ–¥–µ–ª–∏, —Ü–µ–Ω—ã)
‚îÇ   ‚îú‚îÄ‚îÄ lib/           # –£—Ç–∏–ª–∏—Ç—ã –∏ —Å–µ—Ä–≤–∏—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ stores/        # Zustand stores
‚îÇ   ‚îú‚îÄ‚îÄ hooks/         # React hooks
‚îÇ   ‚îú‚îÄ‚îÄ types/         # TypeScript —Ç–∏–ø—ã
‚îÇ   ‚îî‚îÄ‚îÄ providers/     # Context providers
‚îú‚îÄ‚îÄ docs/              # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ scripts/           # –°–∫—Ä–∏–ø—Ç—ã –∏ –≤–æ—Ä–∫–µ—Ä—ã
‚îú‚îÄ‚îÄ public/            # –°—Ç–∞—Ç–∏–∫–∞
‚îî‚îÄ‚îÄ supabase/          # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
```

---

## üîë –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã

| –ß—Ç–æ | –ì–¥–µ |
|-----|-----|
| AI –º–æ–¥–µ–ª–∏ | `src/config/models.ts` |
| –¶–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ | `src/config/pricing.ts`, `src/lib/pricing/` |
| Supabase –∫–ª–∏–µ–Ω—Ç—ã | `src/lib/supabase/` |
| API –∫–ª–∏–µ–Ω—Ç—ã AI | `src/lib/api/` (kie, laozhang, fal, openai) |
| –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä | `src/components/generator-v2/` |
| Stores | `src/stores/` (generation, credits, user) |
| Auth | `src/lib/auth/`, `src/providers/auth-provider.tsx` |

---

## ‚öôÔ∏è –ö–æ–Ω–≤–µ–Ω—Ü–∏–∏ –∫–æ–¥–∞

### –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã: `PascalCase.tsx`
- –£—Ç–∏–ª–∏—Ç—ã/—Ö—É–∫–∏: `camelCase.ts`
- –¢–∏–ø—ã: `PascalCase` (–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —Å `I` –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º)
- API routes: `route.ts` –≤ –ø–∞–ø–∫–µ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º endpoint

### –ò–º–ø–æ—Ä—Ç—ã
```typescript
// 1. React/Next
import { useState } from 'react';
import { useRouter } from 'next/navigation';

// 2. –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏
import { toast } from 'sonner';

// 3. –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ (—á–µ—Ä–µ–∑ alias @/)
import { Button } from '@/components/ui';
import { useCreditsStore } from '@/stores';
import { getModelById } from '@/config/models';
```

### API Routes
```typescript
// src/app/api/example/route.ts
import { NextRequest, NextResponse } from 'next/server';

export async function POST(request: NextRequest) {
  try {
    // 1. –í–∞–ª–∏–¥–∞—Ü–∏—è
    // 2. –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
    // 3. –û—Ç–≤–µ—Ç
    return NextResponse.json({ success: true });
  } catch (error) {
    return NextResponse.json({ error: 'message' }, { status: 500 });
  }
}
```

---

## üö´ –ó–∞–ø—Ä–µ—â–µ–Ω–æ –±–µ–∑ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è

1. **–£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤** ‚Äî –æ—Å–æ–±–µ–Ω–Ω–æ –≤ `src/`
2. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ö–µ–º—ã –ë–î** ‚Äî –º–∏–≥—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Supabase
3. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ `config/models.ts`** ‚Äî –≤–ª–∏—è–µ—Ç –Ω–∞ —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
4. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–ª–∞—Ç—ë–∂–Ω—ã—Ö webhook'–æ–≤** ‚Äî `app/api/webhooks/`
5. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ auth flow** ‚Äî `lib/auth/`, `providers/auth-provider.tsx`

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º

- [ ] `npm run lint` ‚Äî –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] `npm run type-check` ‚Äî —Ç–∏–ø—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- [ ] `npm run build` ‚Äî –±–∏–ª–¥ —É—Å–ø–µ—à–µ–Ω
- [ ] –ò–º–ø–æ—Ä—Ç—ã —á–µ—Ä–µ–∑ `@/` alias
- [ ] –ù–µ—Ç `console.log` (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `lib/logger.ts`)
- [ ] –ù–µ—Ç —Ö–∞—Ä–¥–∫–æ–¥–∞ –∫–ª—é—á–µ–π/—Å–µ–∫—Ä–µ—Ç–æ–≤

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** `docs/ARCHITECTURE.md`
- **–ö–æ–Ω–≤–µ–Ω—Ü–∏–∏:** `docs/CONVENTIONS.md`
- **Changelog:** `docs/CHANGELOG.md`
- **API –º–æ–¥–µ–ª–µ–π:** `MODELS_CONFIG_GUIDE.md`

---

*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 2025-01-16*
