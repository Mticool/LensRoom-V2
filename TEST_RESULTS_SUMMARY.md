# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤–∏–¥–µ–æ

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

### 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ ‚úì

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ grep:**
```bash
‚úÖ veo-3.1-fast: provider: 'laozhang'
‚úÖ sora-2: provider: 'laozhang' // Uses LaoZhang API
‚úÖ baseUrl: "https://api.laozhang.ai/v1"
```

### 2. UI —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä ‚úì

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è: `/create/studio?section=video&model=veo-3.1-fast`
- ‚úÖ –ú–æ–¥–µ–ª—å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è: "Veo 3.1 Fast" —Å –±–µ–π–¥–∂–µ–º "FAST"
- ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è:
  - Prompt: "A cat walking on the street" ‚úì
  - Duration: 8s ‚úì (—Å—Ç–æ–∏–º–æ—Å—Ç—å –æ–±–Ω–æ–≤–∏–ª–∞—Å—å –¥–æ 99 ‚≠ê)
  - Aspect Ratio: 16:9 ‚úì
  - Quality: 1080p ‚úì
- ‚úÖ –ö–Ω–æ–ø–∫–∞ Generate –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç—å—é: "Generate 99"

### 3. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ—Ç–æ–∫–∞ ‚úì

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –≤ –∫–æ–¥–µ:**

1. **UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç** (`VideoGeneratorLight.tsx`):
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `VideoGeneratorHiru` –¥–ª—è —Ñ–æ—Ä–º—ã
   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç `onGenerate` callback

2. **API Route** (`/api/generate/video/route.ts`):
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–æ–≤–∞–π–¥–µ—Ä: `if (modelInfo.provider === 'laozhang')`
   - ‚úÖ –í—ã–∑—ã–≤–∞–µ—Ç `getLaoZhangClient()` –∏ `getLaoZhangVideoModelId()`
   - ‚úÖ –°–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å –≤ `generations` —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "queued"
   - ‚úÖ –í—ã–∑—ã–≤–∞–µ—Ç LaoZhang API —á–µ—Ä–µ–∑ `videoClient.generateVideo()`
   - ‚úÖ –°–∫–∞—á–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≤ Supabase Storage
   - ‚úÖ –û–±–Ω–æ–≤–ª—è–µ—Ç –∑–∞–ø–∏—Å—å: `status: 'success'`, `result_urls: [url]`

3. **LaoZhang Client** (`laozhang-client.ts`):
   - ‚úÖ Base URL: `https://api.laozhang.ai/v1`
   - ‚úÖ Endpoint: `/chat/completions`
   - ‚úÖ Authorization: `Bearer ${LAOZHANG_API_KEY}`
   - ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –æ—Ç–≤–µ—Ç–∞: –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ URL –∏–∑ `[download video](URL)`

4. **–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞** (`/api/library`):
   - ‚úÖ –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å —Ñ–∏–ª—å—Ç—Ä–æ–º `type === 'video'`
   - ‚úÖ –°—Ç—Ä–æ–∏—Ç signed URLs –¥–ª—è –≤–∏–¥–µ–æ
   - ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤ `LibraryClient`

### 4. –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ ‚úì

**–î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- `[API] Video generation request to LaoZhang:` - —Å –ø–æ–ª–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- `[Video API] Request to LaoZhang:` - —Å baseUrl –∏ endpoint
- `[API] Video storage upload:` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–≥—Ä—É–∑–∫–∏
- `[API] Updating generation record:` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î

## üìù –°–æ–∑–¥–∞–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

1. **`scripts/test-video-generation-flow.ts`** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
2. **`scripts/check-video-generation-db.ts`** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø–∏—Å–µ–π –≤ –ë–î
3. **`scripts/test-complete-video-flow.sh`** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
4. **`scripts/verify-video-api-flow.md`** - —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
5. **`VIDEO_GENERATION_TEST_RESULTS.md`** - –ø–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç

## ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª–Ω—ã–π E2E —Ç–µ—Å—Ç –∏–∑-–∑–∞:**
1. –¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (Telegram session)
2. –ù—É–∂–µ–Ω —Ä–µ–∞–ª—å–Ω—ã–π `LAOZHANG_API_KEY` –¥–ª—è API –≤—ã–∑–æ–≤–æ–≤
3. –ö–Ω–æ–ø–∫–∞ Generate —Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–û–¥–Ω–∞–∫–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ –í—Å—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è
- ‚úÖ UI –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- ‚úÖ –ö–æ–¥ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å LaoZhang
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞

–î–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω—É–∂–Ω–æ:

1. **–ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ** (—á–µ—Ä–µ–∑ Telegram)
2. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é** —á–µ—Ä–µ–∑ UI
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞** –Ω–∞ –Ω–∞–ª–∏—á–∏–µ:
   - `[API] Using video provider for model: veo-3.1-fast`
   - `[Video API] Request to LaoZhang:`
   - `[Video API] Got video URL:`
   - `[API] Video storage upload:`
4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:**
   ```bash
   tsx scripts/check-video-generation-db.ts --recent 1
   ```
5. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É:** `/library` –¥–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤–∏–¥–µ–æ

## ‚úÖ –ò—Ç–æ–≥

**–í—Å–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ:**
- –ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- API –∫–ª–∏–µ–Ω—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ  
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î –∏ Storage —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É–ª—É—á—à–µ–Ω–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ —Å LaoZhang API –¥–ª—è Veo 3.1 –∏ Sora 2.**
